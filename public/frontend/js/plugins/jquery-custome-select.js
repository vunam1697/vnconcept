"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _extends(){return(_extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var o,e=arguments[i];for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}).apply(this,arguments)}var CustomSelect=function(_){var o={block:"custom-select",hideCallback:!1,includeValue:!1,keyboard:!0,modifier:!1,placeholder:!1,search:!1,showCallback:!1,transition:0},t=((t=e.prototype).reset=function(){this._$dropdown.hide().empty(),this._$value.off("click"),this._fill()},t._init=function(){this._$element=_('<div class="'+this._options.block+'">\n           <button class="'+this._options.block+"__option "+this._options.block+'__option--value" type="button"></button>\n           <div class="'+this._options.block+'__dropdown" style="display: none;"></div>\n         </div>'),this._$select.hide().after(this._$element),this._options.modifier&&this._$element.addClass(this._options.modifier),this._$value=this._$element.find("."+this._options.block+"__option--value"),this._$dropdown=this._$element.find("."+this._options.block+"__dropdown"),this._fill()},t._fill=function(){var n=this,l=(this._$values=this._$select.find("option"),this._values=[],this._options.placeholder);_.each(this._$values,function(t,i){i=_(i).text().trim();n._values.push(i)}),l&&(this._$select.find("[selected]").length?l=!1:(this._$value.html(l),this._$select.prop("selectedIndex",-1))),_.each(this._values,function(t,i){var o=n._$values.eq(t).attr("class"),e=_('<button class="'+n._options.block+'__option" type="button">'+i+"</button>"),s=n._$select.find(":selected");n._$values.eq(t).attr("disabled")&&e.prop("disabled",!0),!s.length&&0===t||i===s.text().trim()?(l||n._$value.text(i).removeClass(n._$value.data("class")).removeData("class").addClass(o).data("class",o),(n._options.includeValue||l)&&(e.addClass(o),e.toggleClass(n._optionSelectedModifier,n._$values.eq(t).is("[selected]")),n._$dropdown.append(e))):(e.addClass(o),n._$dropdown.append(e))}),this._$options=this._$dropdown.find("."+this._options.block+"__option"),this._options.search&&this._search(),this._$value.one("click",function(t){n._show(t)}),this._$value.prop("disabled",!this._$options.length),this._$options.on("click",function(t){n._select(t)})},t._show=function(t){var i=this;t.preventDefault(),this._dropup(),_(window).on("resize scroll",this._dropup),this._$element.addClass(this._activeModifier),this._$dropdown.slideDown(this._options.transition,function(){i._options.search&&(i._$input.focus(),i._options.includeValue&&i._scroll()),"function"==typeof i._options.showCallback&&i._options.showCallback.call(i._$element[0])}),setTimeout(function(){_(document).on("touchstart click",i._outside)},0),this._$value.one("click",function(t){t.preventDefault(),i._hide()}),this._options.keyboard&&(this._options.index=-1,_(window).on("keydown",this._keydown))},t._hide=function(){var i=this;this._options.search&&(this._$input.val("").blur(),this._$options.show(),this._$wrap.scrollTop(0)),this._$dropdown.slideUp(this._options.transition,function(){i._$element.removeClass(i._activeModifier).removeClass(i._dropupModifier),"function"==typeof i._options.hideCallback&&i._options.hideCallback.call(i._$element[0]),i._$value.off("click").one("click",function(t){i._show(t)}),_(document).off("touchstart click",i._outside),_(window).off("resize scroll",i._dropup)}),this._options.keyboard&&(this._$options.blur(),_(window).off("keydown",this._keydown))},t._scroll=function(){var e=this;_.each(this._$options,function(t,i){var o,i=_(i);if(i.text()===e._$value.text())return o=i.position().top,(i=e._$wrap.outerHeight()/2-i.outerHeight()/2)<o&&e._$wrap.scrollTop(o-i),!1})},t._select=function(t){var i,e=this,s=(t.preventDefault(),_(t.currentTarget).text().trim()),n=[].concat(this._values);this._$value.text(s).removeClass(this._$value.data("class")),this._$values.prop("selected",!1),_.each(n,function(t,i){e._options.includeValue||i!==s||n.splice(t,1),_.each(e._$values,function(t,i){var o,i=_(i);i.text().trim()===s&&(o=i.attr("class"),i.prop("selected",!0),e._$value.addClass(o).data("class",o))})}),this._hide(),this._options.includeValue?(this._$options.removeClass(this._optionSelectedModifier),_.each(this._$options,function(t,i){i=_(i);if(i.text().trim()===s)return i.addClass(e._optionSelectedModifier),!1})):(this._$options.length>n.length&&((i=this._$options.eq(n.length)).remove(),this._$options=this._$options.not(i),this._$options.length||this._$value.prop("disabled",!0)),_.each(this._$options,function(i,t){var o=_(t);o.text(n[i]),o.attr("class",e._options.block+"__option"),_.each(e._$values,function(){var t=_(this);t.text().trim()===n[i]&&(o.addClass(t.attr("class")),o.prop("disabled",t.prop("disabled")))})})),void 0!==t.originalEvent&&this._$select.trigger("change")},t._search=function(){var t=this;this._$input=_('<input class="'+this._options.block+'__input" autocomplete="off">'),this._$dropdown.prepend(this._$input),this._$options.wrapAll('<div class="'+this._options.block+'__option-wrap"></div>'),this._$wrap=this._$element.find("."+this._options.block+"__option-wrap"),this._$input.on("focus",function(){t._options.index=-1}),this._$input.on("keyup",function(){var e=t._$input.val().trim();e.length?(t._$wrap.scrollTop(0),setTimeout(function(){e===t._$input.val().trim()&&_.each(t._$options,function(t,i){var i=_(i),o=-1!==i.text().trim().toLowerCase().indexOf(e.toLowerCase());i.toggle(o)})},300)):t._$options.show()})},t._dropup=function(){var t=this._$element[0].getBoundingClientRect().bottom,t=_(window).height()-t<this._$dropdown.height();this._$element.toggleClass(this._dropupModifier,t)},t._outside=function(t){t=_(t.target);t.parents().is(this._$element)||t.is(this._$element)||this._hide()},t._keydown=function(t){var i,o=this._$options.filter(":visible").not("[disabled]");switch(t.which){case 40:t.preventDefault(),o.eq(this._options.index+1).length?this._options.index+=1:this._options.index=0,o.eq(this._options.index).focus();break;case 38:t.preventDefault(),o.eq(this._options.index-1).length&&0<=this._options.index-1?--this._options.index:this._options.index=o.length-1,o.eq(this._options.index).focus();break;case 13:case 32:this._$input&&this._$input.is(":focus")||(t.preventDefault(),(i=this._$options.add(this._$value).filter(":focus")).trigger("click"),i.is(this._$value)||this._$select.trigger("change"),this._$value.focus());break;case 27:t.preventDefault(),this._hide(),this._$value.focus()}},e._jQueryPlugin=function(o){return this.each(function(){var t=_(this),i=t.data("custom-select");i?"reset"===o&&i.reset():"string"!=typeof o&&(i=new e(this,o),t.data("custom-select",i))})},e);function e(t,i){this._$select=_(t),this._options=_extends({},o,"object"==(void 0===i?"undefined":_typeof(i))?i:{}),this._activeModifier=this._options.block+"--active",this._dropupModifier=this._options.block+"--dropup",this._optionSelectedModifier=this._options.block+"__option--selected",this._keydown=this._keydown.bind(this),this._dropup=this._dropup.bind(this),this._outside=this._outside.bind(this),this._init()}return _.fn.customSelect=t._jQueryPlugin,_.fn.customSelect.noConflict=function(){return _.fn.customSelect},t}($);